var xdcDatachainGateway_widget=function(t){function e(e){for(var a,s,i=e[0],c=e[1],l=e[2],d=0,p=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&p.push(o[s][0]),o[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);for(u&&u(e);p.length;)p.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,i=1;i<n.length;i++){var c=n[i];0!==o[c]&&(a=!1)}a&&(r.splice(e--,1),t=s(s.s=n[0]))}return t}var a={},o={4:0,1:0},r=[];function s(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=a,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(n,a,function(e){return t[e]}.bind(null,a));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/wp-content/plugins/xdc-datachain-gateway/public/dist/";var i=window.webpackJsonpxdcDatachainGateway_name_=window.webpackJsonpxdcDatachainGateway_name_||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=c;return r.push([573,3]),n()}({0:function(t,e){t.exports=React},10:function(t,e){t.exports=tatum_utils},25:function(t,e,n){"use strict";n.d(e,"d",(function(){return s})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return l}));var a=n(10),o=n(51);class r{constructor(){this.requestMemo=void 0,this.localizationMemo=void 0}get request(){return this.requestMemo?this.requestMemo:this.requestMemo=Object(a.createRequestFactory)(o.a.get.optionStore)}get localization(){return this.localizationMemo?this.localizationMemo:this.localizationMemo=Object(a.createLocalizationFactory)(o.a.get.optionStore.pureSlug)}static get get(){return r.me?r.me:r.me=new r}}r.me=void 0;const s=function(){return r.get.request.urlBuilder(...arguments)},i=function(){return r.get.request.request(...arguments)},c=function(){return r.get.localization.__(...arguments)},l=function(){return r.get.localization._i(...arguments)}},263:function(t,e,n){},27:function(t,e,n){"use strict";n.r(e),n.d(e,"Constants",(function(){return a}));const a={slug:"xdc-datachain-gateway",rest:{prefix:"wp-json/xdc-datachain-gateway/v1"},contractAddress:{xdc:{explorer:"https://explorer.xinfin.network",provider:"https://rpc.xinfin.network",erc20:{datachain:{address:"0x20b59e6c5deb7d7ced2ca823c6ca81dd3f7e9a3a",decimals:"18",image:"https://pbs.twimg.com/profile_images/1043846876636860416/VVJngBAZ_400x400.jpg",symbol:"DC",tokenABI:[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"subtractedValue",type:"uint256"}],name:"decreaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"}]}}}}}},280:function(t,e){},286:function(t,e){},287:function(t,e){},311:function(t,e){},313:function(t,e){},322:function(t,e){},324:function(t,e){},334:function(t,e){},336:function(t,e){},36:function(t,e){t.exports=ReactDOM},4:function(t,e){t.exports=mobx},438:function(t,e){},440:function(t,e){},445:function(t,e){},447:function(t,e){},454:function(t,e){},466:function(t,e){},469:function(t,e){},474:function(t,e){},51:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return c}));var a=n(4),o=n(10),r=n(63),s=n(62);Object(a.configure)({enforceActions:"always"});class i{get context(){return this.contextMemo?this.contextMemo:this.contextMemo=Object(o.createContextFactory)(this)}constructor(){this.todoStore=void 0,this.optionStore=void 0,this.contextMemo=void 0,this.todoStore=new r.a(this),this.optionStore=new s.a(this)}static get StoreProvider(){return i.get.context.StoreProvider}static get get(){return i.me?i.me:i.me=new i}}i.me=void 0;const c=()=>i.get.context.useStores()},562:function(t,e,n){},573:function(t,e,n){"use strict";n.r(e);var a=n(10),o=n(36),r=n(51),s=n(27),i=n(0),c=n.n(i),l=n(245),u=n(579);n(562);const d=()=>c.a.createElement("div",{className:"spinner-container"},c.a.createElement(u.a,null));var p=n(146),m=n.n(p),y=n(147),f=n.n(y);const h=()=>{const[t,e]=Object(i.useState)(),[n,a]=Object(i.useState)();Object(i.useEffect)(()=>{l()});const o=async()=>(await window.xdc.enable())[0],r=async()=>{const t=new m.a(s.Constants.contractAddress.xdc.provider),e=new t.eth.Contract(s.Constants.contractAddress.xdc.erc20.datachain.tokenABI,s.Constants.contractAddress.xdc.erc20.datachain.address);return{web3:t,contract:e}},c=(t,e)=>new f.a(t).div(e).toFixed(0,2),l=async()=>{setInterval(async()=>{await(async()=>{var t;null!==(t=window)&&void 0!==t&&t.xdc||a(!1);const e=await window.xdc.enable();return a(e.length>0)})()},1e3)};return{pay:async(t,n,a)=>{const i=c(t,n),l=await(async()=>{const t=await o(),{web3:e,contract:n}=await r(),a=await n.methods.balanceOf(t).call();return new f.a(e.utils.fromWei(a))})();return l.gte(i)?(await(async(t,n)=>{const a=await o(),{contract:i}=await r(),c=i.methods.transfer(n.replace("xdc","0x"),m.a.utils.toBN(t*10**18)).encodeABI();await window.xdc.sendAsync({method:"eth_sendTransaction",params:[{from:a,to:s.Constants.contractAddress.xdc.erc20.datachain.address,data:c}]},(t,n)=>{console.log(t),console.log(n),e(n.result)})})(Number(i),a),{status:"success",message:"OK"}):{status:"error",message:`You dont have enough XDC tokens on your account. On your account you have ${l.toFixed(0,2)} but you want to pay ${i}.`}},txId:t,addDcErc20Token:async()=>{await window.xdc.sendAsync({method:"metamask_watchAsset",params:{type:"ERC20",options:{address:s.Constants.contractAddress.xdc.erc20.datachain.address,decimals:s.Constants.contractAddress.xdc.erc20.datachain.decimals,symbol:s.Constants.contractAddress.xdc.erc20.datachain.symbol,image:s.Constants.contractAddress.xdc.erc20.datachain.image}}},(t,e)=>{console.log(t),console.log(e)})},isXdcPayAvailable:n,getAmountWithoutDecimals:c}},b=(t,e)=>{switch(t){case"XDC":return`${s.Constants.contractAddress.xdc.explorer}/txs/${e}`}throw new Error("Unknown chain")};var g=n(253);const w=t=>g.b.error({content:t});var v=n(25);const x=(t,e)=>{const[n,o]=Object(i.useState)(null),r=async()=>{try{const n=await Object(v.c)({location:{path:t,method:a.RouteHttpVerb.GET},options:e});"error"===(null==n?void 0:n.status)&&n.message&&w(n.message),o(n)}catch(t){w("An error occurred. Please contact support.")}};return Object(i.useEffect)(()=>{!0!==(null==e?void 0:e.lazy)&&r()},[]),{data:n,refetch:r}},T=t=>{let{cartTotal:e}=t;const{pay:n,txId:a,addDcErc20Token:o,isXdcPayAvailable:r,getAmountWithoutDecimals:s}=h();return c.a.createElement("div",{className:"flex flex-col justify-center items-center"},c.a.createElement(O,{cardTotal:e,txId:a,pay:n,addDcErc20Token:o,isXdcPayAvailable:r,getAmountWithoutDecimals:s}))},O=t=>{let{isXdcPayAvailable:e,pay:n,txId:a,addDcErc20Token:o,cardTotal:r,getAmountWithoutDecimals:i}=t;const{data:l}=x("/rate",{restRoot:window.location.origin,restNamespace:s.Constants.rest.prefix}),{data:u}=x("/receive-address",{restRoot:window.location.origin,restNamespace:s.Constants.rest.prefix});return void 0!==e&&l&&u?c.a.createElement(E,{cardTotal:r,txId:a,pay:n,addDcErc20Token:o,isXdcPayAvailable:e,rate:null==l?void 0:l.rate,getAmountWithoutDecimals:i,receiveAddress:u.receiveAddress}):c.a.createElement(d,null)},E=t=>{let{isXdcPayAvailable:e,pay:n,txId:a,addDcErc20Token:o,cardTotal:r,rate:s,getAmountWithoutDecimals:i,receiveAddress:l}=t;return!0===e?c.a.createElement(A,{getAmountWithoutDecimals:i,rate:s,cardTotal:r,txId:a,pay:n,addDcErc20Token:o,receiveAddress:l}):c.a.createElement(C,null)},A=t=>{let{txId:e,pay:n,addDcErc20Token:a,cardTotal:o,rate:r,getAmountWithoutDecimals:s,receiveAddress:u}=t;const[d,p]=Object(i.useState)();return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"font-mulish text-lg uppercase font-bold text-black py-3 "},"Pay with DC tokens on XDC network"),e?c.a.createElement("div",null,c.a.createElement(l.Checkmark,null),c.a.createElement("input",{type:"hidden",value:e,name:"xdc-datachain-gateway-txId"}),c.a.createElement("div",{className:"flex flex-col font-mulish uppercase font-bold text-black"},c.a.createElement("div",{className:"text-center my-2"},"Tx Hash"),c.a.createElement("a",{className:"font-mulish text-sm text-center no-underline hover:underline my-2",target:"_blank",rel:"noreferrer",href:b("XDC",e)},e))):c.a.createElement(c.a.Fragment,null,c.a.createElement(k,null,c.a.createElement("img",{className:"my-4",src:(m="xdc-dc.png",`${window.location.origin}/wp-content/plugins/xdc-datachain-gateway/public/assets/${m}`),onClick:()=>(async(t,e)=>{const{message:a,status:r}=await n(o,e,u);"error"===r&&p(a)})(0,r)})),c.a.createElement("div",{className:"font-mulish text-lg uppercase font-bold text-black my-4"},"Pay ",s(o,r)," XDC"),d&&c.a.createElement("div",{className:"text-rose-600 w-1/2 font-mulish text-lg uppercase font-bold text-black my-4"},d)),c.a.createElement(k,{onClick:a},"Add Datachain token to the XDC Pay"));var m},C=()=>c.a.createElement("div",{className:"font-mulish"},"Please"," ",c.a.createElement("a",{className:"font-mulish",href:"https://chrome.google.com/webstore/detail/xdcpay/bocpokimicclpaiekenaeelehdjllofo"},"install")," ","and login to XDC Pay"),k=t=>{let{children:e,onClick:n}=t;return c.a.createElement("div",{onClick:n,className:"font-mulish w-1/2 text-center cursor-pointer m-3 p-4 text-base font-bold text-gray-900 bg-gray-50 rounded-lg hover:bg-gray-100 group hover:shadow dark:bg-gray-600 dark:hover:bg-gray-500 dark:text-white font-mulish text-sm uppercase font-bold text-black"},e)};n(263);setTimeout(()=>{document.querySelectorAll("div."+s.Constants.slug).forEach(t=>{Object(o.render)(c.a.createElement(r.a.StoreProvider,null,c.a.createElement(T,{cartTotal:t.dataset.cartTotal})),t)})},8e3)},62:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var a,o,r=n(28),s=n.n(r),i=n(21),c=n.n(i),l=(n(57),n(4)),u=n(10);let d=(a=class extends u.BaseOptions{constructor(t){super(),s()(this,"others",o,this),this.pureSlug=void 0,this.pureSlugCamelCased=void 0,this.rootStore=void 0,this.rootStore=t,this.pureSlug=u.BaseOptions.getPureSlug(Object({NODE_ENV:"production",env:"production",rootSlug:"tatum",slug:"xdc-datachain-gateway",wooConsumerKey:void 0,wooConsumerSecret:void 0})),this.pureSlugCamelCased=u.BaseOptions.getPureSlug(Object({NODE_ENV:"production",env:"production",rootSlug:"tatum",slug:"xdc-datachain-gateway",wooConsumerKey:void 0,wooConsumerSecret:void 0}),!0),Object(l.runInAction)(()=>Object.assign(this,window[this.pureSlugCamelCased]))}},o=c()(a.prototype,"others",[l.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),a)},63:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var a,o,r,s,i=n(28),c=n.n(i),l=n(21),u=n.n(l),d=(n(57),n(4));let p=(a=class{constructor(t,e){c()(this,"title",o,this),c()(this,"completed",r,this),c()(this,"id",s,this),this.store=void 0,this.id=t.todos.length+1,this.store=t,this.title=e}toggle(){this.completed=!this.completed}destroy(){this.store.todos.splice(this.store.todos.indexOf(this),1)}setTitle(t){this.title=t}},o=u()(a.prototype,"title",[d.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r=u()(a.prototype,"completed",[d.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=u()(a.prototype,"id",[d.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u()(a.prototype,"toggle",[d.action],Object.getOwnPropertyDescriptor(a.prototype,"toggle"),a.prototype),u()(a.prototype,"destroy",[d.action],Object.getOwnPropertyDescriptor(a.prototype,"destroy"),a.prototype),u()(a.prototype,"setTitle",[d.action],Object.getOwnPropertyDescriptor(a.prototype,"setTitle"),a.prototype),a);var m,y;let f=(m=class{constructor(t){c()(this,"todos",y,this),this.rootStore=void 0,this.rootStore=t}add(t){this.todos.push(new p(this,t))}},y=u()(m.prototype,"todos",[d.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),u()(m.prototype,"add",[d.action],Object.getOwnPropertyDescriptor(m.prototype,"add"),m.prototype),m)}});
//# sourceMappingURL=widget.js.map